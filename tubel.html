<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Tugas Belajar - SINGGATERA</title>
    <link rel="icon" type="image/png" href="favicon.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      /* ===== VARIABLES & RESET ===== */
      :root {
        --primary: #2563eb;
        --primary-dark: #1d4ed8;
        --primary-light: #3b82f6;
        --secondary: #7c3aed;
        --accent: #f59e0b;
        --accent-alt: #10b981;
        --danger: #ef4444;
        --warning: #fbbf24;
        --success: #10b981;
        --light: #f8fafc;
        --light-gray: #f1f5f9;
        --gray: #64748b;
        --dark: #1e293b;
        --dark-blue: #0f172a;

        --gradient-primary: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
        --gradient-secondary: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
        --gradient-accent: linear-gradient(135deg, #10b981 0%, #3b82f6 100%);
        --gradient-dark: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);

        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
        --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.12);
        --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.15);
        --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.2);

        --border-radius-sm: 8px;
        --border-radius: 12px;
        --border-radius-lg: 20px;
        --border-radius-xl: 28px;

        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        scroll-behavior: smooth;
        scroll-padding-top: 80px;
      }

      body {
        font-family: "Inter", sans-serif;
        color: var(--dark);
        background-color: var(--light);
        line-height: 1.6;
        overflow-x: hidden;
      }

      h1,
      h2,
      h3,
      h4,
      h5 {
        font-family: "Poppins", sans-serif;
        font-weight: 700;
        line-height: 1.2;
      }

      section {
        padding: 80px 20px;
      }

      .container {
        max-width: 1280px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .section-header {
        text-align: center;
        margin-bottom: 50px;
      }

      .section-tag {
        display: inline-block;
        background: var(--gradient-accent);
        color: white;
        padding: 6px 16px;
        border-radius: 30px;
        font-size: 13px;
        font-weight: 600;
        letter-spacing: 0.5px;
        margin-bottom: 15px;
      }

      .section-title {
        font-size: 2.4rem;
        color: var(--dark-blue);
        margin-bottom: 15px;
        position: relative;
        display: inline-block;
      }

      .section-title::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: var(--gradient-primary);
        border-radius: 2px;
      }

      .section-subtitle {
        font-size: 1.1rem;
        color: var(--gray);
        max-width: 700px;
        margin: 0 auto;
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 12px 28px;
        border-radius: var(--border-radius);
        font-weight: 600;
        font-size: 15px;
        cursor: pointer;
        transition: var(--transition);
        border: none;
        text-decoration: none;
        position: relative;
        overflow: hidden;
      }

      .btn::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.6s;
      }

      .btn:hover::after {
        left: 100%;
      }

      .btn-primary {
        background: var(--gradient-primary);
        color: white;
        box-shadow: var(--shadow-md);
      }

      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      .btn-secondary {
        background: white;
        color: var(--primary);
        border: 2px solid var(--primary);
      }

      .btn-secondary:hover {
        background: var(--primary);
        color: white;
        transform: translateY(-3px);
      }

      .btn-accent {
        background: var(--gradient-accent);
        color: white;
        box-shadow: var(--shadow-md);
      }

      .btn-accent:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      .btn-outline {
        background: transparent;
        color: var(--primary);
        border: 2px solid var(--primary);
      }

      .btn-outline:hover {
        background: var(--primary);
        color: white;
      }

      .card {
        background: white;
        border-radius: var(--border-radius);
        padding: 25px;
        box-shadow: var(--shadow-md);
        transition: var(--transition);
        height: 100%;
      }

      .card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-xl);
      }

      /* ===== HEADER ===== */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        transition: var(--transition);
      }

      .header.scrolled {
        box-shadow: var(--shadow-md);
      }

      .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        text-decoration: none;
      }

      .logo-img {
        height: 45px;
        width: auto;
      }

      .logo-text {
        display: flex;
        flex-direction: column;
      }

      .logo-title {
        font-size: 1.6rem;
        font-weight: 800;
        color: var(--primary);
        line-height: 1;
      }

      .logo-subtitle {
        font-size: 0.85rem;
        color: var(--gray);
        font-weight: 500;
      }

      .nav {
        display: flex;
        align-items: center;
        gap: 30px;
      }

      .nav-links {
        display: flex;
        gap: 25px;
        list-style: none;
      }

      .nav-link {
        color: var(--dark);
        text-decoration: none;
        font-weight: 600;
        font-size: 0.95rem;
        position: relative;
        padding: 8px 0;
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--gradient-primary);
        border-radius: 2px;
        transition: width 0.3s ease;
      }

      .nav-link:hover::after,
      .nav-link.active::after {
        width: 100%;
      }

      .nav-link.active {
        color: var(--primary);
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .search-box {
        position: relative;
      }

      .search-input {
        width: 280px;
        padding: 10px 18px 10px 40px;
        border: 2px solid var(--light-gray);
        border-radius: var(--border-radius);
        font-size: 0.9rem;
        transition: var(--transition);
        background: white;
      }

      .search-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        width: 320px;
      }

      .search-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray);
      }

      .user-profile {
        position: relative;
      }

      .user-btn {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: var(--light-gray);
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: var(--transition);
        min-width: 160px;
      }

      .user-btn:hover {
        background: var(--primary-light);
        color: white;
      }

      .user-btn:hover .user-icon {
        background: white;
        color: var(--primary);
      }

      .user-icon {
        width: 32px;
        height: 32px;
        background: var(--gradient-primary);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
      }

      .user-name {
        font-weight: 600;
        flex-grow: 1;
      }

      .user-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        width: 260px;
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-xl);
        margin-top: 8px;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: var(--transition);
        z-index: 100;
      }

      .user-dropdown.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .user-info {
        padding: 18px;
        border-bottom: 1px solid var(--light-gray);
      }

      .user-email {
        color: var(--gray);
        font-size: 0.85rem;
        margin-top: 5px;
      }

      .dropdown-links {
        padding: 12px;
      }

      .dropdown-link {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        border-radius: var(--border-radius-sm);
        transition: var(--transition);
        color: var(--dark);
        text-decoration: none;
      }

      .dropdown-link:hover {
        background: var(--light-gray);
        color: var(--primary);
      }

      .dropdown-link i {
        width: 20px;
        color: var(--primary);
      }

      .mobile-toggle {
        display: none;
        font-size: 1.3rem;
        cursor: pointer;
        color: var(--dark);
      }

      /* ===== DASHBOARD CONTENT ===== */
      .dashboard-header {
        padding: 120px 20px 40px;
        background: var(--gradient-dark);
        color: white;
        position: relative;
        overflow: hidden;
      }

      .dashboard-header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 20% 50%,
            rgba(37, 99, 235, 0.15) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(124, 58, 237, 0.1) 0%,
            transparent 50%
          );
      }

      .dashboard-title {
        font-size: 2.8rem;
        margin-bottom: 15px;
        line-height: 1.1;
        position: relative;
        z-index: 1;
      }

      .dashboard-title span {
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .dashboard-subtitle {
        font-size: 1.3rem;
        color: rgba(255, 255, 255, 0.9);
        margin-bottom: 25px;
        position: relative;
        z-index: 1;
      }

      .back-button {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        background: var(--gradient-accent);
        color: white;
        padding: 12px 28px;
        border-radius: var(--border-radius);
        text-decoration: none;
        font-weight: 600;
        margin-bottom: 30px;
        transition: var(--transition);
        position: relative;
        z-index: 1;
        border: none;
      }

      .back-button:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      /* ===== YEAR FILTER ===== */
      .year-filters {
        display: flex;
        justify-content: center;
        gap: 12px;
        margin: 40px 0;
        flex-wrap: wrap;
      }

      .year-btn {
        padding: 10px 24px;
        border: 2px solid var(--primary);
        background: white;
        color: var(--primary);
        font-weight: 600;
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: var(--transition);
        font-size: 0.9rem;
      }

      .year-btn:hover {
        background: var(--primary-light);
        color: white;
      }

      .year-btn.active {
        background: var(--gradient-primary);
        color: white;
        box-shadow: var(--shadow-md);
        border-color: transparent;
      }

      /* ===== STATS CARDS ===== */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
        margin: 40px 0;
      }

      .stat-card {
        background: white;
        border-radius: var(--border-radius);
        padding: 30px;
        box-shadow: var(--shadow-md);
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: var(--transition);
        border: 1px solid transparent;
      }

      .stat-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-xl);
        border-color: var(--primary-light);
      }

      .stat-content h3 {
        font-size: 1rem;
        color: var(--gray);
        margin-bottom: 10px;
        font-weight: 600;
      }

      .stat-content .number {
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--dark-blue);
      }

      .stat-icon {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.2rem;
      }

      .stat-card:nth-child(1) .stat-icon {
        background: linear-gradient(135deg, #f59e0b33, #fbbf2433);
        color: var(--accent);
      }

      .stat-card:nth-child(1) .number {
        color: var(--accent);
      }

      .stat-card:nth-child(2) .stat-icon {
        background: linear-gradient(135deg, #10b98133, #34d39933);
        color: var(--success);
      }

      .stat-card:nth-child(2) .number {
        color: var(--success);
      }

      .stat-card:nth-child(3) .stat-icon {
        background: linear-gradient(135deg, #3b82f633, #60a5fa33);
        color: var(--primary);
      }

      .stat-card:nth-child(3) .number {
        color: var(--primary);
      }

      /* ===== CHART SECTION ===== */
      .chart-section {
        background: white;
        border-radius: var(--border-radius);
        padding: 30px;
        box-shadow: var(--shadow-md);
        margin: 40px 0;
      }

      .chart-container {
        height: 400px;
        position: relative;
      }

      /* ===== JENJANG STATS ===== */
      .jenjang-stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .jenjang-card {
        background: white;
        border-radius: var(--border-radius);
        padding: 25px;
        box-shadow: var(--shadow-md);
        text-align: center;
        transition: var(--transition);
        border-top: 4px solid transparent;
      }

      .jenjang-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .jenjang-card.D4 { border-top-color: #f59e0b; }
      .jenjang-card.S1 { border-top-color: #10b981; }
      .jenjang-card.S2 { border-top-color: #3b82f6; }
      .jenjang-card.S3 { border-top-color: #8b5cf6; }
      .jenjang-card.Profesi { border-top-color: #ef4444; }
      .jenjang-card.Spesialis { border-top-color: #ec4899; }

      .jenjang-name {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--dark-blue);
        margin-bottom: 10px;
      }

      .jenjang-count {
        font-size: 2.2rem;
        font-weight: 800;
        margin-bottom: 5px;
      }

      .jenjang-card.D4 .jenjang-count { color: #f59e0b; }
      .jenjang-card.S1 .jenjang-count { color: #10b981; }
      .jenjang-card.S2 .jenjang-count { color: #3b82f6; }
      .jenjang-card.S3 .jenjang-count { color: #8b5cf6; }
      .jenjang-card.Profesi .jenjang-count { color: #ef4444; }
      .jenjang-card.Spesialis .jenjang-count { color: #ec4899; }

      .jenjang-total {
        font-size: 0.9rem;
        color: var(--gray);
        background: var(--light-gray);
        padding: 4px 12px;
        border-radius: 20px;
        display: inline-block;
      }

      /* ===== INTERACTIVE FLOW ===== */
      .flow-section {
        margin: 60px 0;
      }

      .flow-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
      }

      .flow-step {
        flex: 1;
        min-width: 250px;
        max-width: 300px;
        background: white;
        border-radius: var(--border-radius);
        padding: 30px;
        box-shadow: var(--shadow-md);
        text-align: center;
        position: relative;
        transition: var(--transition);
        border-top: 4px solid var(--primary);
      }

      .flow-step:hover {
        transform: translateY(-10px);
        box-shadow: var(--shadow-xl);
      }

      .step-number {
        position: absolute;
        top: -15px;
        left: 50%;
        transform: translateX(-50%);
        width: 40px;
        height: 40px;
        background: var(--gradient-primary);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.2rem;
        box-shadow: var(--shadow-md);
      }

      .step-icon {
        font-size: 2.5rem;
        margin-bottom: 20px;
        color: var(--primary);
      }

      .flow-step h3 {
        font-size: 1.3rem;
        color: var(--dark-blue);
        margin-bottom: 15px;
      }

      .flow-step p {
        color: var(--gray);
        font-size: 0.95rem;
        line-height: 1.6;
      }

      /* ===== REQUIREMENTS TABLE ===== */
      .requirements-section {
        margin: 60px 0;
      }

      .requirements-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: var(--shadow-md);
      }

      .requirements-table thead {
        background: var(--gradient-primary);
        color: white;
      }

      .requirements-table th {
        padding: 20px;
        text-align: left;
        font-weight: 600;
        font-size: 1rem;
      }

      .requirements-table tbody tr {
        border-bottom: 1px solid var(--light-gray);
        transition: var(--transition);
      }

      .requirements-table tbody tr:hover {
        background: var(--light-gray);
      }

      .requirements-table td {
        padding: 18px 20px;
        color: var(--dark);
      }

      .requirements-table tbody tr:nth-child(even) {
        background: rgba(241, 245, 249, 0.5);
      }

      /* ===== LEGAL DOCS ===== */
      .legal-docs-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
        margin-top: 30px;
      }

      .doc-card {
        background: white;
        border-radius: var(--border-radius);
        padding: 25px;
        box-shadow: var(--shadow-md);
        transition: var(--transition);
        display: flex;
        align-items: center;
        border-left: 4px solid var(--accent);
      }

      .doc-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-xl);
      }

      .doc-icon {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #f59e0b33, #fbbf2433);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 20px;
        font-size: 1.8rem;
        color: var(--accent);
      }

      .doc-content h4 {
        font-size: 1.1rem;
        color: var(--dark-blue);
        margin-bottom: 5px;
      }

      .doc-content p {
        color: var(--gray);
        font-size: 0.9rem;
      }

      /* ===== INSTITUTIONS SECTION ===== */
      .institutions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 25px;
        margin-top: 30px;
      }

      .institution-card {
        background: white;
        border-radius: var(--border-radius);
        padding: 25px;
        box-shadow: var(--shadow-md);
        transition: var(--transition);
        display: flex;
        align-items: center;
        border: 1px solid transparent;
      }

      .institution-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-xl);
        border-color: var(--primary-light);
      }

      .institution-logo {
        width: 70px;
        height: 70px;
        border-radius: 12px;
        object-fit: cover;
        margin-right: 20px;
        border: 2px solid var(--light-gray);
      }

      .institution-content {
        flex: 1;
      }

      .institution-content h4 {
        font-size: 1.1rem;
        color: var(--dark-blue);
        margin-bottom: 5px;
      }

      .institution-content p {
        color: var(--gray);
        font-size: 0.9rem;
        margin-bottom: 10px;
      }

      .institution-count {
        display: inline-block;
        background: var(--gradient-accent);
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
      }

      /* ===== LOADING & ERROR STATES ===== */
      .loading {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 60px;
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-md);
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 4px solid var(--light-gray);
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .error-message {
        background: white;
        border-radius: var(--border-radius);
        padding: 30px;
        text-align: center;
        box-shadow: var(--shadow-md);
        border-left: 4px solid var(--danger);
      }

      .error-message i {
        font-size: 3rem;
        color: var(--danger);
        margin-bottom: 15px;
      }

      .error-message p {
        color: var(--gray);
        margin-bottom: 20px;
      }

      /* ===== FOOTER ===== */
      .footer {
        background: var(--dark-blue);
        color: white;
        padding: 60px 20px 25px;
        position: relative;
        overflow: hidden;
        margin-top: 60px;
      }

      .footer::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 0% 100%,
            rgba(37, 99, 235, 0.15) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 100% 0%,
            rgba(124, 58, 237, 0.15) 0%,
            transparent 50%
          );
      }

      .footer-container {
        position: relative;
        z-index: 1;
      }

      .footer-content {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 30px;
        margin-bottom: 40px;
      }

      .footer-col h4 {
        font-size: 1.1rem;
        margin-bottom: 20px;
        color: white;
        position: relative;
      }

      .footer-col h4::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 0;
        width: 35px;
        height: 2px;
        background: var(--gradient-primary);
        border-radius: 2px;
      }

      .footer-logo img {
        height: 40px;
        margin-bottom: 15px;
      }

      .footer-logo p {
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.5;
        margin-bottom: 20px;
        font-size: 0.9rem;
      }

      .footer-links ul {
        list-style: none;
      }

      .footer-links li {
        margin-bottom: 10px;
      }

      .footer-links a {
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
      }

      .footer-links a:hover {
        color: white;
        transform: translateX(5px);
      }

      .footer-contact .contact-item {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        margin-bottom: 15px;
      }

      .footer-contact i {
        color: var(--accent);
        font-size: 1rem;
        margin-top: 4px;
      }

      .footer-contact p {
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.5;
        font-size: 0.9rem;
      }

      .partner-logos {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
        padding: 30px 0;
        margin: 30px 0;
      }

      .partner-logo {
        height: 35px;
        opacity: 0.9;
        transition: var(--transition);
      }

      .partner-logo:hover {
        opacity: 1;
        transform: scale(1.1);
      }

      .footer-bottom {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 20px;
      }

      .copyright {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.85rem;
      }

      .copyright a {
        color: var(--accent);
        text-decoration: none;
      }

      .copyright a:hover {
        text-decoration: underline;
      }

      .social-links {
        display: flex;
        gap: 12px;
      }

      .social-link {
        width: 36px;
        height: 36px;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        transition: var(--transition);
      }

      .social-link:hover {
        background: var(--primary);
        transform: translateY(-3px);
      }

      /* ===== SCROLL TO TOP ===== */
      .scroll-top {
        position: fixed;
        bottom: 25px;
        right: 25px;
        width: 45px;
        height: 45px;
        background: var(--gradient-primary);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        cursor: pointer;
        opacity: 0;
        visibility: hidden;
        transform: translateY(20px);
        transition: var(--transition);
        z-index: 999;
        box-shadow: var(--shadow-lg);
      }

      .scroll-top.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .scroll-top:hover {
        transform: translateY(-5px);
      }

      /* ===== ANIMATIONS ===== */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(15px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in {
        animation: fadeIn 0.5s ease forwards;
      }

      /* ===== RESPONSIVE DESIGN ===== */
      @media (max-width: 1200px) {
        .footer-content {
          grid-template-columns: repeat(2, 1fr);
        }

        .flow-container {
          flex-direction: column;
          align-items: center;
        }

        .flow-step {
          width: 100%;
          max-width: 500px;
        }
      }

      @media (max-width: 992px) {
        .section-title {
          font-size: 2rem;
        }

        .dashboard-title {
          font-size: 2.2rem;
        }

        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .jenjang-stats-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      @media (max-width: 768px) {
        .nav {
          position: fixed;
          top: 70px;
          left: -100%;
          width: 100%;
          height: calc(100vh - 70px);
          background: white;
          flex-direction: column;
          align-items: center;
          padding: 40px 20px;
          transition: left 0.4s ease;
          box-shadow: var(--shadow-lg);
        }

        .nav.active {
          left: 0;
        }

        .nav-links {
          flex-direction: column;
          align-items: center;
          width: 100%;
        }

        .nav-link {
          font-size: 1rem;
        }

        .header-actions {
          flex-direction: column;
          width: 100%;
          gap: 12px;
        }

        .search-input {
          width: 100%;
        }

        .search-input:focus {
          width: 100%;
        }

        .mobile-toggle {
          display: block;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .jenjang-stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .year-filters {
          flex-direction: column;
          align-items: center;
        }

        .year-btn {
          width: 100%;
          max-width: 300px;
        }

        .requirements-table {
          display: block;
          overflow-x: auto;
        }

        .footer-content {
          grid-template-columns: 1fr;
        }

        .footer-bottom {
          flex-direction: column;
          gap: 15px;
          text-align: center;
        }

        .chart-container {
          height: 300px;
        }
      }

      @media (max-width: 576px) {
        .section-title {
          font-size: 1.6rem;
        }

        .dashboard-title {
          font-size: 1.8rem;
        }

        .stat-content .number {
          font-size: 2rem;
        }

        .stat-icon {
          width: 50px;
          height: 50px;
          font-size: 1.8rem;
        }

        .jenjang-stats-grid {
          grid-template-columns: 1fr;
        }

        .legal-docs-grid,
        .institutions-grid {
          grid-template-columns: 1fr;
        }

        .doc-card,
        .institution-card {
          flex-direction: column;
          text-align: center;
        }

        .doc-icon {
          margin-right: 0;
          margin-bottom: 15px;
        }

        .institution-logo {
          margin-right: 0;
          margin-bottom: 15px;
        }

        .user-btn {
          min-width: auto;
          padding: 6px 12px;
        }

        .user-name {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- ===== HEADER ===== -->
    <header class="header" id="header">
      <div class="container header-container">
        <a href="index.html" class="logo">
          <img
            src="https://i.ibb.co.com/JWw8qHmM/logo-bkpsdm.png"
            alt="BKPSDM Logo"
            class="logo-img"
          />
          <div class="logo-text">
            <div class="logo-title">SINGGATERA</div>
            <div class="logo-subtitle">BKPSDM Kabupaten Ciamis</div>
          </div>
        </a>

        <nav class="nav" id="nav">
          <ul class="nav-links">
            <li><a href="index.html" class="nav-link">Home</a></li>
            <li><a href="ksf.html" class="nav-link">Konsultasi & Saran</a></li>
            <li><a href="informasi.html" class="nav-link">Informasi</a></li>
            <li>
              <a href="tubel.html" class="nav-link active">Tugas Belajar</a>
            </li>
          </ul>

          <div class="header-actions">
            <div class="search-box">
              <i class="fas fa-search search-icon"></i>
              <input
                type="text"
                class="search-input"
                placeholder="Cari informasi..."
              />
            </div>

            <div class="user-profile">
              <div class="user-btn" id="userBtn">
                <div class="user-icon">
                  <i class="fas fa-user"></i>
                </div>
                <div class="user-name" id="userName">Guest</div>
                <i class="fas fa-chevron-down"></i>
              </div>

              <div class="user-dropdown" id="userDropdown">
                <div class="user-info">
                  <h4 id="dropdownName">Guest</h4>
                  <p class="user-email" id="dropdownEmail">-</p>
                </div>
                <div class="dropdown-links">
                  <a href="profile.html" class="dropdown-link">
                    <i class="fas fa-user-circle"></i>
                    <span>Profil Saya</span>
                  </a>
                  <a href="settings.html" class="dropdown-link">
                    <i class="fas fa-cog"></i>
                    <span>Pengaturan</span>
                  </a>
                  <a href="activities.html" class="dropdown-link">
                    <i class="fas fa-history"></i>
                    <span>Riwayat</span>
                  </a>
                  <a href="#" class="dropdown-link" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Keluar</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </nav>

        <div class="mobile-toggle" id="mobileToggle">
          <i class="fas fa-bars"></i>
        </div>
      </div>
    </header>

    <!-- ===== DASHBOARD HEADER ===== -->
    <section class="dashboard-header">
      <div class="container">
        <a href="index.html" class="back-button">
          <i class="fas fa-arrow-left"></i> Kembali ke Home
        </a>
        <h1 class="dashboard-title">Dashboard <span>Tugas Belajar</span></h1>
        <p class="dashboard-subtitle">
          Monitoring dan analisis data tugas belajar ASN Kabupaten Ciamis
        </p>
      </div>
    </section>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="container">
      <!-- Statistik Section -->
      <section class="stats-section">
        <div class="section-header">
          <div class="section-tag">REKAPITULASI DATA</div>
          <h2 class="section-title">Statistik Tugas Belajar</h2>
          <p class="section-subtitle">
            Data terbaru peserta tugas belajar berdasarkan tahun akademik
          </p>
        </div>

        <!-- Year Filter -->
        <div class="year-filters">
          <button class="year-btn active" onclick="changeYear(2025)">
            2025
          </button>
          <button class="year-btn" onclick="changeYear(2024)">2024</button>
          <button class="year-btn" onclick="changeYear(2023)">2023</button>
          <button class="year-btn" onclick="changeYear(2022)">2022</button>
          <button class="year-btn" onclick="changeYear('all')">Semua Tahun</button>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid" id="statsCards">
          <div class="loading">
            <div class="spinner"></div>
            <p>Memuat data statistik...</p>
          </div>
        </div>

        <!-- Jenjang Pendidikan Stats -->
        <div class="section-header" style="margin-top: 60px;">
          <div class="section-tag">JENJANG PENDIDIKAN</div>
          <h2 class="section-title">Distribusi Jenjang Pendidikan</h2>
          <p class="section-subtitle">
            Data peserta berdasarkan jenjang pendidikan pada tahun terpilih
          </p>
        </div>
        
        <div class="jenjang-stats-grid" id="jenjangStats">
          <div class="loading">
            <div class="spinner"></div>
            <p>Memuat data jenjang pendidikan...</p>
          </div>
        </div>
      </section>

      <!-- Chart Section -->
      <section class="chart-section">
        <div class="section-header">
          <div class="section-tag">ANALISIS TREN</div>
          <h2 class="section-title">Distribusi Jenjang Pendidikan</h2>
          <p class="section-subtitle">
            Persentase peserta berdasarkan jenjang pendidikan pada tahun terpilih
          </p>
        </div>
        <div class="chart-container">
          <canvas id="tubelChart"></canvas>
        </div>
      </section>

      <!-- Alur Proses Section -->
      <section class="flow-section">
        <div class="section-header">
          <div class="section-tag">PROSEDUR</div>
          <h2 class="section-title">Alur Pengajuan Tugas Belajar</h2>
          <p class="section-subtitle">
            Tahapan lengkap proses pengajuan tugas belajar PNS
          </p>
        </div>

        <div class="flow-container">
          <div class="flow-step fade-in">
            <div class="step-number">1</div>
            <div class="step-icon"><i class="fas fa-file-signature"></i></div>
            <h3>Pengajuan Permohonan</h3>
            <p>
              Pegawai mengajukan permohonan tugas belajar kepada atasan langsung
              dengan melengkapi formulir yang disediakan.
            </p>
          </div>

          <div class="flow-step fade-in">
            <div class="step-number">2</div>
            <div class="step-icon"><i class="fas fa-check-double"></i></div>
            <h3>Rekomendasi Atasan</h3>
            <p>
              Atasan memberikan rekomendasi dan meneruskan berkas ke pimpinan
              unit kerja untuk persetujuan.
            </p>
          </div>

          <div class="flow-step fade-in">
            <div class="step-number">3</div>
            <div class="step-icon"><i class="fas fa-paper-plane"></i></div>
            <h3>Penyampaian ke BKPSDM</h3>
            <p>
              Pimpinan unit kerja mengirimkan berkas lengkap ke BKPSDM untuk
              proses lebih lanjut.
            </p>
          </div>

          <div class="flow-step fade-in">
            <div class="step-number">4</div>
            <div class="step-icon"><i class="fas fa-search"></i></div>
            <h3>Verifikasi Administrasi</h3>
            <p>
              BKPSDM melakukan verifikasi kelengkapan dan validitas dokumen
              sesuai ketentuan yang berlaku.
            </p>
          </div>

          <div class="flow-step fade-in">
            <div class="step-number">5</div>
            <div class="step-icon">
              <i class="fas fa-envelope-open-text"></i>
            </div>
            <h3>Penyampaian Hasil</h3>
            <p>
              Hasil proses dari BKPSDM disampaikan kepada pegawai yang
              bersangkutan melalui unit kerja asal.
            </p>
          </div>
        </div>
      </section>

      <!-- Persyaratan Section -->
      <section class="requirements-section">
        <div class="section-header">
          <div class="section-tag">DOKUMEN</div>
          <h2 class="section-title">Persyaratan Tugas Belajar</h2>
          <p class="section-subtitle">
            Kelengkapan dokumen yang diperlukan untuk pengajuan tugas belajar
          </p>
        </div>

        <div class="table-responsive">
          <table class="requirements-table">
            <thead>
              <tr>
                <th>No</th>
                <th>Dokumen</th>
                <th>Keterangan</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Surat Permohonan diketahui atasan langsung (form 1)</td>
                <td>Asli</td>
              </tr>
              <tr>
                <td>2</td>
                <td>
                  Surat Rekomendasi tugas belajar dari Kepala OPD (form 2 & 3)
                </td>
                <td>Asli</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Surat Pengantar Kepala OPD (form 4)</td>
                <td>Asli</td>
              </tr>
              <tr>
                <td>4</td>
                <td>SK PNS</td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>5</td>
                <td>SK Jabatan</td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>6</td>
                <td>
                  Pedoman Penyelenggaraan program studi (memuat tentang nama
                  program studi yang diikuti dan masa perkuliahan)
                </td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>7</td>
                <td>SK Pangkat terakhir</td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>8</td>
                <td>PPK PNS 2 tahun terakhir</td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Surat Keterangan Sehat</td>
                <td>Asli</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Surat Keterangan Tidak Sedang / Tidak Pernah (form 5)</td>
                <td>Asli bermaterai</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Surat Perjanjian Tugas Belajar</td>
                <td>Asli</td>
              </tr>
              <tr>
                <td>12</td>
                <td>
                  Surat Keterangan Beasiswa dan/atau Surat Keterangan Lulus
                  Seleksi
                </td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>13</td>
                <td>Surat Keterangan Akreditasi Program Studi</td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>14</td>
                <td>Izin Seleksi</td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>15</td>
                <td>Jadwal Kuliah</td>
                <td>Copy legalisir</td>
              </tr>
              <tr>
                <td>16</td>
                <td>Surat Persetujuan Kelas Jauh, Kelas Malam, Sabtu Minggu</td>
                <td>Copy legalisir</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Dokumen Hukum Section -->
      <section class="legal-docs-section">
        <div class="section-header">
          <div class="section-tag">REGULASI</div>
          <h2 class="section-title">Dokumen Hukum Terkait</h2>
          <p class="section-subtitle">
            Regulasi dan peraturan yang mengatur tentang tugas belajar
          </p>
        </div>

        <div class="legal-docs-grid">
          <div class="doc-card" data-file="PP 11 Tahun 2017">
            <div class="doc-icon">
              <i class="fas fa-balance-scale"></i>
            </div>
            <div class="doc-content">
              <h4>PP 11 Tahun 2017</h4>
              <p>Manajemen PNS</p>
            </div>
          </div>

          <div class="doc-card" data-file="PerKa BKN No. 2 Tahun 2017">
            <div class="doc-icon">
              <i class="fas fa-balance-scale"></i>
            </div>
            <div class="doc-content">
              <h4>PerKa BKN No. 2 Tahun 2017</h4>
              <p>Tata Cara Pemberian Tugas Belajar</p>
            </div>
          </div>

          <div class="doc-card" data-file="Peraturan Gubernur">
            <div class="doc-icon">
              <i class="fas fa-balance-scale"></i>
            </div>
            <div class="doc-content">
              <h4>Peraturan Gubernur</h4>
              <p>Regulasi Tugas Belajar Daerah</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Lembaga Pendidikan Section -->
      <section class="institutions-section">
        <div class="section-header">
          <div class="section-tag">MITRA</div>
          <h2 class="section-title">Lembaga Pendidikan Terpopuler</h2>
          <p class="section-subtitle">
            Perguruan tinggi favorit peserta tugas belajar (diurutkan berdasarkan peminat)
          </p>
        </div>

        <div class="institutions-grid" id="institutionList">
          <div class="loading">
            <div class="spinner"></div>
            <p>Memuat data lembaga pendidikan...</p>
          </div>
        </div>
      </section>
    </main>

    <!-- ===== FOOTER ===== -->
    <footer class="footer">
      <div class="container footer-container">
        <div class="footer-content">
          <div class="footer-col footer-logo">
            <img
              src="https://i.ibb.co.com/JWw8qHmM/logo-bkpsdm.png"
              alt="BKPSDM Logo"
            />
            <p>
              Sistem Informasi Bidang Pengembangan Kompetensi Aparatur
              (SINGGATERA) merupakan platform digital terpadu untuk meningkatkan
              kompetensi dan profesionalisme ASN Kabupaten Ciamis.
            </p>

            <a
              href="https://docs.google.com/forms/d/e/1FAIpQLSdl9y1wT1xNR-D3MYOnwTVkp9eJWdN7NbAkl8DTyjOpm-QhTQ/viewform"
              class="btn btn-accent"
              target="_blank"
            >
              <i class="fas fa-clipboard-check"></i> Form Evaluasi
            </a>
          </div>

          <div class="footer-col footer-links">
            <h4>Link Cepat</h4>
            <ul>
              <li>
                <a href="index.html"><i class="fas fa-home"></i> Beranda</a>
              </li>
              <li>
                <a href="pelatihan.html"
                  ><i class="fas fa-user-tie"></i> Pelatihan</a
                >
              </li>
              <li>
                <a href="asesmen.html"
                  ><i class="fas fa-chart-bar"></i> Asesmen</a
                >
              </li>
              <li>
                <a href="tubel.html"
                  ><i class="fas fa-graduation-cap"></i> Tugas Belajar</a
                >
              </li>
            </ul>
          </div>

          <div class="footer-col footer-links">
            <h4>Layanan</h4>
            <ul>
              <li>
                <a href="ksf.html"
                  ><i class="fas fa-comments"></i> Konsultasi & Saran</a
                >
              </li>
              <li>
                <a href="informasi.html"
                  ><i class="fas fa-newspaper"></i> Informasi Terkini</a
                >
              </li>
              <li>
                <a href="#"><i class="fas fa-download"></i> Unduhan</a>
              </li>
              <li>
                <a href="#"><i class="fas fa-question-circle"></i> Bantuan</a>
              </li>
            </ul>
          </div>

          <div class="footer-col footer-contact">
            <h4>Kontak Kami</h4>
            <div class="contact-item">
              <i class="fas fa-map-marker-alt"></i>
              <p>
                Jl. Sadananya No. 27, Kelurahan Maleber, Kecamatan Ciamis,
                Kabupaten Ciamis
              </p>
            </div>

            <div class="contact-item">
              <i class="fas fa-envelope"></i>
              <p>pka@ciamiskab.go.id<br />bkpsdm@ciamiskab.go.id</p>
            </div>

            <div class="contact-item">
              <i class="fas fa-phone"></i>
              <p>(0265) 771234<br />Senin - Jumat, 08:00 - 16:00 WIB</p>
            </div>
          </div>
        </div>

        <div class="partner-logos">
          <img
            src="https://i.ibb.co.com/tMnbFSr5/Lambang-Kabupaten-Ciamis.png"
            alt="Lambang Kabupaten Ciamis"
            class="partner-logo"
          />
          <img
            src="https://i.ibb.co.com/JWw8qHmM/logo-bkpsdm.png"
            alt="Logo BKPSDM"
            class="partner-logo"
          />
          <img
            src="https://i.ibb.co.com/6JvSKyNf/Logo-Ber-AKHLAK-svg.png"
            alt="Logo BerAKHLAK"
            class="partner-logo"
          />
          <img
            src="https://i.ibb.co.com/99NKJGNg/bangga.png"
            alt="Bangga Melayani Bangsa"
            class="partner-logo"
          />
        </div>

        <div class="footer-bottom">
          <div class="copyright">
            <p>
              &copy; <span id="currentYear">2025</span>
              <a href="https://www.pka-bkpsdm-ciamiskab.my.id/home"
                >PKA BKPSDM Kabupaten Ciamis</a
              >. All Rights Reserved.
            </p>
            <p>Versi 2.0 | Terakhir diperbarui: Desember 2025</p>
          </div>

          <div class="social-links">
            <a href="#" class="social-link"
              ><i class="fab fa-facebook-f"></i
            ></a>
            <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
            <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
            <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
          </div>
        </div>
      </div>
    </footer>

    <!-- ===== SCROLL TO TOP BUTTON ===== -->
    <div class="scroll-top" id="scrollTop">
      <i class="fas fa-arrow-up"></i>
    </div>

    <script>
      // ====== VARIABLES ======
      const scriptUrl = "https://script.google.com/macros/s/AKfycbzctyZVhXwAp1A6wRq0Ovl6YUCsy5urMUYqSSj2LOrpyIr5TPD9xDtBCJpFEeVx9Cxe/exec";
      
      let allData = {};
      let chart;
      let currentYear = 2025;

      // Data statis dari spreadsheet yang diberikan (sebagai fallback)
      const staticChartData = {
        2022: [
          { jenjang: "D4", count: 1 },
          { jenjang: "Dokter Spesialis", count: 1 },
          { jenjang: "Profesi Bidan", count: 1 },
          { jenjang: "Profesi Ners", count: 1 },
          { jenjang: "S1", count: 14 },
          { jenjang: "S2", count: 16 },
          { jenjang: "S3", count: 2 },
          { jenjang: "Spesialis Bedah", count: 1 },
          { jenjang: "Spesialis Kedokteran", count: 1 },
          { jenjang: "Spesialis Radiologi", count: 1 }
        ],
        2023: [
          { jenjang: "D4", count: 7 },
          { jenjang: "Dokter Spesialis", count: 1 },
          { jenjang: "Profesi Bidan", count: 4 },
          { jenjang: "Profesi Ners", count: 7 },
          { jenjang: "S1", count: 24 },
          { jenjang: "S2", count: 40 },
          { jenjang: "S3", count: 11 },
          { jenjang: "Spesialis Bedah", count: 1 },
          { jenjang: "Spesialis Radiologi", count: 1 }
        ],
        2024: [
          { jenjang: "D4", count: 6 },
          { jenjang: "Profesi Bidan", count: 25 },
          { jenjang: "Profesi Ners", count: 7 },
          { jenjang: "S1", count: 55 },
          { jenjang: "S2", count: 50 },
          { jenjang: "S3", count: 3 },
          { jenjang: "Spesialis Mikrobiologi", count: 1 },
          { jenjang: "Spesialis Patologi", count: 1 },
          { jenjang: "Spesialis Radiologi", count: 1 }
        ],
        2025: [
          { jenjang: "D4", count: 7 },
          { jenjang: "Profesi Bidan", count: 31 },
          { jenjang: "Profesi Ners", count: 2 },
          { jenjang: "S1", count: 25 },
          { jenjang: "S2", count: 25 },
          { jenjang: "Spesialis Bedah", count: 1 },
          { jenjang: "Spesialis Radiologi", count: 1 }
        ],
        all: [
          { jenjang: "D4", count: 21 },
          { jenjang: "Dokter Spesialis", count: 1 },
          { jenjang: "Profesi Bidan", count: 61 },
          { jenjang: "Profesi Ners", count: 17 },
          { jenjang: "S1", count: 118 },
          { jenjang: "S2", count: 131 },
          { jenjang: "S3", count: 16 },
          { jenjang: "Spesialis Bedah", count: 2 },
          { jenjang: "Spesialis Kedokteran", count: 1 },
          { jenjang: "Spesialis Mikrobiologi", count: 1 },
          { jenjang: "Spesialis Patologi", count: 1 },
          { jenjang: "Spesialis Radiologi", count: 3 }
        ]
      };

      // Total per tahun
      const yearTotals = {
        2022: 36,
        2023: 96,
        2024: 149,
        2025: 92,
        all: 373
      };

      // ====== DOM ELEMENTS ======
      const header = document.getElementById("header");
      const nav = document.getElementById("nav");
      const mobileToggle = document.getElementById("mobileToggle");
      const userBtn = document.getElementById("userBtn");
      const userDropdown = document.getElementById("userDropdown");
      const logoutBtn = document.getElementById("logoutBtn");
      const scrollTopBtn = document.getElementById("scrollTop");
      const userName = document.getElementById("userName");
      const dropdownName = document.getElementById("dropdownName");
      const dropdownEmail = document.getElementById("dropdownEmail");

      // ====== FUNCTIONS ======
      async function fetchData() {
        try {
          // Tampilkan loading state
          document.getElementById("statsCards").innerHTML = `
            <div class="loading">
              <div class="spinner"></div>
              <p>Memuat data statistik...</p>
            </div>
          `;

          document.getElementById("jenjangStats").innerHTML = `
            <div class="loading">
              <div class="spinner"></div>
              <p>Memuat data jenjang pendidikan...</p>
            </div>
          `;

          document.getElementById("institutionList").innerHTML = `
            <div class="loading">
              <div class="spinner"></div>
              <p>Memuat data lembaga pendidikan...</p>
            </div>
          `;

          // Fetch data dari GAS
          const res = await fetch(scriptUrl);
          if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
          
          const data = await res.json();
          allData = data;
          
          console.log('Data from GAS:', data); // Debug

          // Update UI dengan data dari GAS
          updateCards(currentYear);
          updateJenjangStats(currentYear);
          renderChart(currentYear);
          
          if (data.institutions && data.institutions.length > 0) {
            renderInstitutions(data.institutions);
          } else {
            renderInstitutions([]);
          }
        } catch (error) {
          console.error("Error fetching data:", error);
          
          // Gunakan data statis sebagai fallback
          allData = {
            stats: [
              { year: 2022, total: 36 },
              { year: 2023, total: 96 },
              { year: 2024, total: 149 },
              { year: 2025, total: 92 }
            ],
            institutions: []
          };
          
          updateCards(currentYear);
          updateJenjangStats(currentYear);
          renderChart(currentYear);
          renderInstitutions([]);
          
          document.getElementById("institutionList").innerHTML = `
            <div class="error-message">
              <i class="fas fa-university"></i>
              <p>Data lembaga pendidikan tidak tersedia</p>
            </div>
          `;
        }
      }

      function changeYear(year) {
        currentYear = year;
        document.querySelectorAll(".year-btn").forEach((btn) => {
          btn.classList.remove("active");
          if (btn.textContent == year || (year === 'all' && btn.textContent === 'Semua Tahun')) {
            btn.classList.add("active");
          }
        });
        updateCards(year);
        updateJenjangStats(year);
        renderChart(year);
      }

      function updateCards(year) {
        let total = yearTotals[year] || 0;
        
        const container = document.getElementById("statsCards");

        container.innerHTML = `
          <div class="stat-card fade-in">
            <div class="stat-content">
              <h3>Total Peserta</h3>
              <div class="number">${total}</div>
            </div>
            <div class="stat-icon">
              <i class="fas fa-users"></i>
            </div>
          </div>
          <div class="stat-card fade-in">
            <div class="stat-content">
              <h3>Tahun Aktif</h3>
              <div class="number">${year === 'all' ? '4' : '1'}</div>
            </div>
            <div class="stat-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
          </div>
          <div class="stat-card fade-in">
            <div class="stat-content">
              <h3>Jenjang Pendidikan</h3>
              <div class="number">${staticChartData[year]?.length || '0'}</div>
            </div>
            <div class="stat-icon">
              <i class="fas fa-graduation-cap"></i>
            </div>
          </div>
        `;
      }

      function updateJenjangStats(year) {
        const jenjangData = staticChartData[year] || [];
        const container = document.getElementById("jenjangStats");
        
        if (jenjangData.length === 0) {
          container.innerHTML = `
            <div class="error-message">
              <i class="fas fa-university"></i>
              <p>Data jenjang pendidikan tidak tersedia untuk tahun ${year}</p>
            </div>
          `;
          return;
        }

        // Kelompokkan data berdasarkan kategori
        const categorizedData = {
          "D4": [],
          "S1": [],
          "S2": [],
          "S3": [],
          "Profesi": [],
          "Spesialis": []
        };

        jenjangData.forEach(item => {
          if (item.jenjang === "D4") {
            categorizedData.D4.push(item);
          } else if (item.jenjang.startsWith("S1") || item.jenjang === "S1") {
            categorizedData.S1.push(item);
          } else if (item.jenjang.startsWith("S2") || item.jenjang === "S2") {
            categorizedData.S2.push(item);
          } else if (item.jenjang.startsWith("S3") || item.jenjang === "S3") {
            categorizedData.S3.push(item);
          } else if (item.jenjang.includes("Profesi") || item.jenjang.includes("Bidan") || item.jenjang.includes("Ners")) {
            categorizedData.Profesi.push(item);
          } else if (item.jenjang.includes("Spesialis") || item.jenjang.includes("Dokter")) {
            categorizedData.Spesialis.push(item);
          }
        });

        // Hitung total per kategori
        const categories = Object.keys(categorizedData).filter(cat => categorizedData[cat].length > 0);
        
        container.innerHTML = categories.map(category => {
          const totalCount = categorizedData[category].reduce((sum, item) => sum + item.count, 0);
          const itemsCount = categorizedData[category].length;
          
          let displayName = category;
          if (category === "Profesi") displayName = "Profesi";
          if (category === "Spesialis") displayName = "Spesialis";
          
          return `
            <div class="jenjang-card ${category} fade-in">
              <div class="jenjang-name">${displayName}</div>
              <div class="jenjang-count">${totalCount}</div>
              <div class="jenjang-total">${itemsCount} program</div>
            </div>
          `;
        }).join("");
      }

      function renderChart(year) {
        const ctx = document.getElementById("tubelChart").getContext("2d");
        const jenjangData = staticChartData[year] || [];
        
        if (chart) chart.destroy();

        if (jenjangData.length === 0) {
          ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
          ctx.font = "16px 'Poppins', sans-serif";
          ctx.fillStyle = "#64748b";
          ctx.textAlign = "center";
          ctx.fillText("Tidak ada data untuk tahun ini", ctx.canvas.width/2, ctx.canvas.height/2);
          return;
        }

        // Warna untuk chart
        const colors = [
          '#f59e0b', '#10b981', '#3b82f6', '#8b5cf6', '#ec4899', '#ef4444',
          '#fbbf24', '#34d399', '#60a5fa', '#a78bfa', '#f472b6', '#fb7185',
          '#f97316', '#22c55e', '#0ea5e9', '#a855f7'
        ];

        const labels = jenjangData.map(item => item.jenjang);
        const data = jenjangData.map(item => item.count);
        const backgroundColors = jenjangData.map((_, i) => colors[i % colors.length]);

        chart = new Chart(ctx, {
          type: "doughnut",
          data: {
            labels: labels,
            datasets: [{
              data: data,
              backgroundColor: backgroundColors,
              borderWidth: 2,
              borderColor: 'white',
              hoverOffset: 15
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { 
                display: true, 
                position: 'right',
                labels: {
                  font: { 
                    family: "'Inter', sans-serif",
                    size: 11
                  },
                  padding: 15,
                  usePointStyle: true,
                  pointStyle: 'circle',
                  boxWidth: 10
                }
              },
              title: {
                display: true,
                text: `Distribusi Jenjang Pendidikan ${year === 'all' ? 'Semua Tahun' : 'Tahun ' + year}`,
                font: { 
                  size: 16, 
                  family: "'Poppins', sans-serif" 
                },
                color: "#1e293b",
                padding: 20
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const label = context.label || '';
                    const value = context.raw || 0;
                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                    const percentage = Math.round((value / total) * 100);
                    return `${label}: ${value} peserta (${percentage}%)`;
                  }
                }
              }
            },
            cutout: '50%',
            animation: {
              animateScale: true,
              animateRotate: true
            }
          }
        });
      }

      function renderInstitutions(institutions) {
        if (!institutions || institutions.length === 0) {
          const container = document.getElementById("institutionList");
          container.innerHTML = `
            <div class="error-message">
              <i class="fas fa-university"></i>
              <p>Data lembaga pendidikan tidak tersedia</p>
            </div>
          `;
          return;
        }

        // Urutkan berdasarkan jumlah peserta (descending)
        const sorted = institutions.sort((a, b) => (b.jumlah || 0) - (a.jumlah || 0));
        const container = document.getElementById("institutionList");
        
        container.innerHTML = sorted
          .map(
            (inst) => `
          <div class="institution-card fade-in">
            <img src="${
              inst.logo || "https://via.placeholder.com/70x70?text=Lembaga"
            }" class="institution-logo" alt="${inst.nama}" />
            <div class="institution-content">
              <h4>${inst.nama}</h4>
              <p>${inst.jumlah || 0} Peserta  ${inst.tipe || '-'}</p>
              <span class="institution-count">${inst.tahun || '-'}</span>
            </div>
          </div>`
          )
          .join("");
      }

      function setupLegalDocsInteractions() {
        const docCards = document.querySelectorAll(".doc-card");
        docCards.forEach((card) => {
          card.addEventListener("click", function () {
            const fileName = this.getAttribute("data-file");
            alert(
              `Dokumen: ${fileName}\n\nFitur ini akan mengarahkan ke halaman/link unduh dokumen terkait.`
            );
          });
        });
      }

      function checkLoginStatus() {
        const loginData = localStorage.getItem("loginData");
        if (loginData) {
          const userData = JSON.parse(loginData);
          userName.textContent = userData.name;
          dropdownName.textContent = userData.name;
          dropdownEmail.textContent =
            userData.email || userData.username || "-";
        } else {
          userName.textContent = "Guest";
          dropdownName.textContent = "Guest";
          dropdownEmail.textContent = "Silakan login untuk akses lengkap";
        }
      }

      // ====== EVENT LISTENERS ======
      window.addEventListener("scroll", () => {
        if (window.scrollY > 50) {
          header.classList.add("scrolled");
        } else {
          header.classList.remove("scrolled");
        }

        if (window.scrollY > 500) {
          scrollTopBtn.classList.add("active");
        } else {
          scrollTopBtn.classList.remove("active");
        }

        // Animate elements on scroll
        const elements = document.querySelectorAll(".fade-in");
        elements.forEach((element) => {
          const elementTop = element.getBoundingClientRect().top;
          const windowHeight = window.innerHeight;
          if (elementTop < windowHeight - 100) {
            element.style.opacity = "1";
            element.style.transform = "translateY(0)";
          }
        });
      });

      mobileToggle.addEventListener("click", () => {
        nav.classList.toggle("active");
        mobileToggle.innerHTML = nav.classList.contains("active")
          ? '<i class="fas fa-times"></i>'
          : '<i class="fas fa-bars"></i>';
      });

      userBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        userDropdown.classList.toggle("active");
      });

      document.addEventListener("click", (e) => {
        if (!nav.contains(e.target) && !mobileToggle.contains(e.target)) {
          nav.classList.remove("active");
          mobileToggle.innerHTML = '<i class="fas fa-bars"></i>';
        }
        userDropdown.classList.remove("active");
      });

      logoutBtn.addEventListener("click", (e) => {
        e.preventDefault();
        localStorage.removeItem("loginData");
        alert("Anda telah keluar dari sistem.");
        window.location.reload();
      });

      scrollTopBtn.addEventListener("click", () => {
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      // Search functionality
      const searchInput = document.querySelector(".search-input");
      if (searchInput) {
        searchInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") {
            const query = searchInput.value.trim();
            if (query) {
              alert(`Melakukan pencarian untuk: "${query}"`);
            }
          }
        });
      }

      // ====== INITIALIZE ======
      function initializeDashboard() {
        fetchData();
        setupLegalDocsInteractions();
        checkLoginStatus();

        // Set current year in footer
        const currentYear = new Date().getFullYear();
        const yearElement = document.getElementById("currentYear");
        if (yearElement) {
          yearElement.textContent = currentYear;
        }

        // Initial animation
        setTimeout(() => {
          document.querySelectorAll(".fade-in").forEach((el, i) => {
            el.style.animationDelay = `${i * 0.1}s`;
          });
        }, 100);
      }

      document.addEventListener("DOMContentLoaded", initializeDashboard);
    </script>
  </body>
</html>
